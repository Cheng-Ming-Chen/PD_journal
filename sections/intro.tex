Massive MIMO is a promising technology for the 5G wireless communication system. Thanks to the excess amount of antennas in the base station (BS), massive MIMO is capable of providing an order of spatial multiplexing gain as compared to the legacy system by simple linear signal processing algorithms \cite{marzetta2010noncooperative}. 
This multiplexing gain is harvested while coherently combines the data signal with the channel state information (CSI). Therefore, the acquisition of CSI is considered as the central activity in massive MIMO. In a time-division duplex (TDD) system, one can rely on channel reciprocity to obtain downlink (DL) CSI efficiently from sending uplink (UL) pilot sequences with the length proportional to the number of active user equipments (UEs). It is vital that the coherent combining gain can only be exploited in the finite channel coherence block. Therefore, the duration of a frame packet which consists of pilot, UL and DL data is usually limit to the coherent time. To maximize the spectral efficiency (SE), the channel resource utilizes for pilot should be designed economically. However, when the length of the pilot sequence is limited, the number of orthogonal pilot codes is limited accordingly. The unavoidable pilot reuse among cells for massive MIMO transmission, where within the cell use orthogonal pilots,
while the same set of orthogonal pilots is reused among cells results in the pilot contamination. Pilot contamination caused by inter-cell pilot reuse is always describes as the limit factor of SE for massive MIMO\cite{marzetta2010noncooperative,jose2011pilot}. 

The two main impacts caused by pilot contamination include: first, the channel estimation degrades due to the pilot interference; second, the contaminated channel combines coherently both desired and interfered signals during the data transmission. Therefore, although with the excess number of antenna, noise, fast fading and intra-cell interference are vanished, the inter-cell interference from pilot contamination cannot be eliminated and limit the SE\cite{marzetta2010noncooperative,bjornson2017massive}. 

Many work have been proposed about mitigating pilot contamination also known as pilot decontamination. The focus of this paper will be in the category of pilot-based estimation approach\cite{elijah2016comprehensive}\footnote{Subspace-based estimation approach is out of our scope as their accuracy depends on large number of antennas and the sampling rate in the coherence time.}. Pilot sequence allocation for inter-cell users with different channel support has been proposed in\cite{yin2013coordinated,adhikary2013joint,you2015pilot}. This method utilizes channel covariance matrices of both desired and interfering UEs. It has significant improvement but is restricted for channels with orthogonal support. Furthermore, this method assumes the individual channel covariance information has been available in advance. In \cite{bjornson2016massive}, the authors showed that to have individual channel covariance is not necessary in improving channel estimation. By a two-stage estimation procedure, one can collect the summation of channel covariance from UEs which caused pilot contamination with some extra pilot overhead. However, as they do not collect individual channel information, this method still could not deal channels with overlapping support. In \cite{ngo2017cell}, a greedy pilot scheduling was proposed. In each iteration, the algorithm first checks the UE with the lowest SE. Then, updates the pilot assignment to schedule away that UE. This procedure iterates until all UEs meet their SE criterion. Two concerns of this method include: First, the rescheduling is not time efficient and accurate. The pilot reallocation is triggered by assuming the bad SE is due to pilot contamination. Second, without individual channel information, the system still cannot avoid interference which might coherently combined in the data transmission phase. In summary, most of the research work focus on improving channel estimation by either Bayesian estimation or greedy pilot rescheduling. The Bayesian estimation improves significantly if there is no overlapping in the channel support. The greedy pilot rescheduling tries to improve channel estimation, but UEs with similar angular support are still in the same pool for data transmission. Finally, inter-cell interference is still unavoidable.

% \begin{figure*} 
% \centering
% \begin{subfigure}[b]{0.1\textwidth}
%    \hspace{0mm}          %\includegraphics[trim=9.2cm 2.3cm 6.5cm 2cm,clip,width=0.8\linewidth]
% \includegraphics[viewport=250 85 2000 490, clip, scale=0.3]
% {figures/pilot_contamination_figure1.eps}\caption{}%\caption{Uplink pilot training phase: Pilot contamination in Cell 0 is caused by the interfering user from Cell 1 which has channel with similar angular support to the desired user. The pilot contamination cannot be eliminated by the Bayesian estimator. Note: while active users are involved in the pilot and data transmission in a coherence block, the inactive users are waiting for the service in the other coherence blocks.}
% \label{fig:PC_of_OVERLAP}
% \end{subfigure}

% %\centering
% \begin{subfigure}[b]{0.1\textwidth}
%    \hspace{0mm}          %\includegraphics[trim=9.2cm 2.3cm 6.5cm 2cm,clip,width=0.8\linewidth]
% \includegraphics[viewport=250 125 2200 490, clip, scale=0.3]
% {figures/pilot_contamination_figure2.eps}\caption{}%\caption{Uplink pilot training phase: Pilot coordination can improve channel estimation quality. The users with difference angular support are scheduled together, and relying on the Bayesian channel estimator, the channel estimation can be improved significantly.}
% \label{fig:PC_of_NOOVERLAP}
% \end{subfigure}

% %\centering
% \begin{subfigure}[b]{0.1\textwidth}
%    \hspace{0mm}          %\includegraphics[trim=9.2cm 2.3cm 6.5cm 2cm,clip,width=0.8\linewidth]
% \includegraphics[viewport=250 125 2200 490, clip, scale=0.3]
% {figures/pilot_contamination_figure3.eps}\caption{}%\caption{Uplink data transmission phase (we only show the data transmission to the Cell 0): Only pilot coordination cannot fully avoids the interference being coherently combined during data transmission.}
% \label{fig:PC_of_DATA}
% \end{subfigure}

%     %\centering
%   %\subfloat[Uplink pilot training phase: Pilot contamination in Cell 0 is caused by the interfering user from Cell 1 which has channel with similar angular support to the desired user. The pilot contamination cannot be eliminated by the Bayesian estimator. Note: while active users are involved in the pilot and data transmission in a coherence block, the inactive users are waiting for the service in the other coherence blocks.]{%
%  %      \includegraphics[trim={9.2cm 2.3cm 6.5cm 2cm},clip,width=0.8\linewidth]{figures/pilot_contamination_figure1.eps}}
% %    \label{fig:1a}\hfill
% %  \subfloat[Uplink pilot training phase: Pilot coordination can improve channel estimation quality. The users with difference angular support are scheduled together, and relying on the Bayesian channel estimator, the channel estimation can be improved significantly.]{%
% %        \includegraphics[trim={9.2cm 3.3cm 6.5cm 2cm},clip,width=0.8\linewidth]{figures/pilot_contamination_figure2.eps}}
% %     \label{fig:1b}\hfill
% %\subfloat[Uplink data transmission phase (we only show the data transmission to the Cell 0): Only pilot coordination cannot fully avoids the interference being coherently combined during data transmission.]{%
% %        \includegraphics[trim={8.5cm 3.3cm 6.5cm 2cm},clip,width=0.8\linewidth]{figures/pilot_contamination_figure3.eps}}
% %     \label{fig:1c} 
%   \caption{\ref{fig:PC_of_OVERLAP} and \ref{fig:PC_of_NOOVERLAP} demonstrate the inter-cell interference in the channel estimation phase. While \ref{fig:PC_of_OVERLAP} shows two users with high overlap in angular support, \ref{fig:PC_of_NOOVERLAP} illustrates the effect of pilot rescheduling to assign a pilot sequence to two UEs with different angular support. However, if there are any UEs among the active UE set to have similar angular support, only pilot rescheduling cannot avoid the inter-cell interference as demonstrated in \ref{fig:PC_of_DATA}. Eventually, the system has to replace the active UE which shares similar angular support in the active UE set to the other inactive UE in the network. Note: while active users are involved in the pilot and data transmission in a coherence block, the inactive users are waiting to be served in the other coherence blocks.}
%   \label{fig1} 
% \end{figure*}

% trim={<left> <lower> <right> <upper>}

\begin{figure*} [htp]
    \centering
  \subfloat[]{%
       \includegraphics[trim=9.2cm 2.3cm 6.5cm 2cm,clip, width=0.3\linewidth]{figures/pilot_contamination_figure1.eps} \label{fig:PC_of_OVERLAP}}
    \hfill
  \subfloat[]{%
        \includegraphics[trim=9.2cm 2.3cm 6.5cm 2cm,clip, width=0.3\linewidth]{figures/pilot_contamination_figure2.eps}\label{fig:PC_of_NOOVERLAP}}
    \hfill
  \subfloat[]{%
        \includegraphics[trim={8cm 2.3cm 6.5cm 1.6cm},clip,width=0.31\linewidth]{figures/pilot_contamination_figure3.eps}\label{fig:PC_of_DATA}}
    \hfill
  \caption{\protect\subref{fig:PC_of_OVERLAP} and \protect\subref{fig:PC_of_NOOVERLAP} demonstrate the inter-cell interference in the channel estimation phase. While \protect\subref{fig:PC_of_OVERLAP} shows two users with high overlap in angular support, \protect\subref{fig:PC_of_NOOVERLAP} illustrates the effect of pilot rescheduling to assign a pilot sequence to two UEs with different angular support. However, if there are any UEs among the active UE set to have similar angular support, only pilot rescheduling cannot avoid the inter-cell interference as demonstrated in \protect\subref{fig:PC_of_DATA}. Eventually, the system has to replace the active UE which shares similar angular support in the active UE set to the other inactive UE in the network. Note: while active users are involved in the pilot and data transmission in a coherence block, the inactive users are waiting to be served in the other coherence blocks.}
\end{figure*}

From the related work, we have two findings: First, there is still no efficient method of pre-determining the channel correlation of UEs which are scheduled in the same pilot code. Our argument is that even relying on greedy scheduling, there is a big delay till the criterion of minimum SE is met which is highly dependent on the propagation environment. 
%Moreover, the number of iterations is highly dependent to the environment. 
We therefore propose to apply a deep learning model on the contaminated pilots and detect if there is high correlation in their angular support. With this, we can reschedule the pilot sequences in an earlier phase precisely as shown in Fig.\ref{fig:PC_of_NOOVERLAP}. Second, a key point here is that if the UEs have similar channel support, by rescheduling their pilots, one can improve the channel estimation, but cannot avoid the high channel correlation in the data transmission as illustrated in Fig. \ref{fig:PC_of_DATA}. Instead of rescheduling the pilot to improve channel estimation, one might even have to drop the UE which might potentially cause high inter-cell interference during the data transmission.  %The authors in \cite{fernandes2013inter} proposed a time-shifted pilot allocation protocol. By joint frame scheduling with neighboring cells, UL pilot of self cell overlaps only with DL precoded data in the other cells. The only pilot contamination source comes only from the neighboring BSs, and hence the interference is less critical as in the data phase does not combined coherently. However, it is very challenging to joint schedule the traffic planning among multiple cells.
We summarize our contributions and challenges as follows:
\begin{itemize}

\item We address the impact of pilot contamination with a system model. A special highlight from the impact of a coherently combined interference is given (Section II). 

\item We propose a deep learning assisted channel estimation improvement algorithm under pilot contamination (Section III). In \cite{Chen2018pilot}, we have verified that channel measured from a real propagation environment, the angular support from one UE can be much more complicated than a simple one-ring model. It it extremely difficult to distinguish if the two channels are from similar angles. %An important conclusion is that there is a high correlation of the channel support to the contaminated channel estimation error. 
We propose to apply deep learning to separate the contaminated channel information. By separating the angular information, we can schedule away the two users who shared very similar angular support.

\item We further improve the SE by comparing the channel correlation of all intra and inter-cell users (Section III). Traditional pilot rescheduling only improves channel estimation but cannot avoid the coherent combining of the interference UEs.
\item We measure the channel to demonstrate in the later section that our deep learning model can handle also complicated channels (Section IV). 
\item We compare the channel estimation improvement with the machine learning assisted algorithm to the traditional method. We run a system level simulation with one-ring model and also our measured channel to demonstrate the advantages of applying pilot and user scheduling (Section V).
%\item    Why is it hard? (Why do naive approaches fail?)
%\begin{itemize}
%\item Very complex channel environments
%\end{itemize}
%\item What's wrong with previous proposed solutions?
%\begin{itemize}
%\item Fill this
%\end{itemize}
%\item  What are the key components of our approach and results? Also include any specific limitations. 
%\begin{itemize}
%\item \ac{aae} based contamination detection and channel estimation
%\item User septation in the angular domain
%\item Code re-allocation to reduce angular overlap which helps in better channel estimation
%\end{itemize}
%\item Our key contributions
%\begin{itemize}
%\item Fill this
%\end{itemize}
\end{itemize}
The notations in this paper are as follows. Uppercase boldface $\mathbf{A}$ denotes a matrix while lowercase
boldface $\mathbf{a}$ indicates a column vector.
Superscripts $T$, $H$, $-1$ and $*$ mean the transpose, Hermitian, inverse operation of a matrix and complex conjugate operation respectively. Moreover, $\E{(.)}$, $\left\Vert\mathbf{A}\right\Vert$ and $tr(.)$ are the expectation operation, $\ell^2$-norm of the matrix $\mathbf{A}$ and trace operation, respectively. Finally, $vec\{.\}$, $\otimes$ and $\arg\{.\}$ represent vectorized operation, Kronecker product and argument of a function, respectively.  


